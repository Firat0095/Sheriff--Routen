<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Standorte & Routen</title>

<style>
  :root{
    --bg:#0e1014; --panel:#151a22; --border:#232a36; --text:#eaeaea; --muted:#9aa4b2;
    --accent:#3b82f6; --ok:#22c55e;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);}

  /* Sheriff Stern Hintergrund */
  body::before{
    content:""; position:fixed; inset:0; pointer-events:none;
    background-repeat:no-repeat; background-position:center;
    background-size:min(120vw, 1200px);
    opacity:.22;
    filter:drop-shadow(0 0 26px rgba(255,205,60,.60))
           drop-shadow(0 0 75px rgba(255,160,0,.35));
    background-image:url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="900" viewBox="0 0 900 900">\
<defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1">\
<stop offset="0" stop-color="%23FFE59A"/><stop offset="0.55" stop-color="%23FFBF3D"/><stop offset="1" stop-color="%23B87810"/>\
</linearGradient></defs>\
<g fill="none" stroke="url(%23g)" stroke-width="30">\
<path d="M450 70l78 140 158-20-30 154 140 78-140 78 30 154-158-20-78 140-78-140-158 20 30-154-140-78 140-78-30-154 158 20z"/>\
<circle cx="450" cy="450" r="230"/>\
</g></svg>');
  }

  .app{
    display:grid;
    grid-template-columns:360px 1fr 380px;
    height:100vh;
    gap:14px;
    padding:14px;
  }
  .panel{
    background:rgba(21,26,34,.92);
    backdrop-filter: blur(6px);
    border:1px solid var(--border);
    border-radius:16px;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    min-height:0;
  }
  .panelHeader{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    padding:12px 14px;
    border-bottom:1px solid var(--border);
    background:#101522;
  }
  .brand{display:flex;align-items:center;gap:10px;min-width:0;}
  .mark{
    width:34px;height:34px;border-radius:10px;
    border:1px solid var(--border);
    display:grid;place-items:center;background:#0f131b;flex:0 0 auto;
  }
  .brandTitle{font-size:15px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
  .subRight{color:var(--muted);font-size:12px;white-space:nowrap}

  .searchWrap{ padding:12px 14px; border-bottom:1px solid var(--border); }
  .search{
    width:100%;padding:10px 12px;border-radius:10px;
    border:1px solid var(--border);
    background:#0f131b;color:var(--text);outline:none;
  }

  .scroll{ overflow:auto; padding:12px 14px; min-height:0; }

  .summary{
    border:1px solid var(--border);
    border-radius:14px;
    background:#0f131b;
    padding:10px 12px;
    margin-bottom:12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .summary b{font-size:13px;}
  .pill{
    font-size:12px; padding:2px 8px; border-radius:999px;
    border:1px solid var(--border); color:var(--muted);
  }
  .pill.ok{border-color:rgba(34,197,94,.45); color:var(--ok);}

  .group{margin-top:12px;border:1px solid var(--border);border-radius:14px;overflow:hidden;background:#0f131b;}
  .group:first-child{margin-top:0;}
  .groupHeader{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    padding:10px 12px;cursor:pointer;user-select:none;background:#101522;
  }
  .groupHeader .left{display:flex;align-items:center;gap:8px;}
  .groupHeader b{font-size:13px;}
  .badgeCount{color:var(--muted);font-size:12px;}

  .groupBody{padding:10px;display:flex;flex-direction:column;gap:8px;}
  .item{
    padding:10px 12px;border-radius:12px;border:1px solid var(--border);
    background:#0b0f17;cursor:pointer;user-select:none;
    display:flex;align-items:center;justify-content:space-between;gap:10px;
  }
  .item:hover{filter:brightness(1.08);}
  .item.active{border-color:var(--accent); box-shadow:0 0 0 2px rgba(59,130,246,.25) inset;}
  .statusBadge{
    font-size:12px; padding:2px 8px; border-radius:999px;
    border:1px solid var(--border); color:var(--muted);
    white-space:nowrap;
  }
  .statusBadge.ok{border-color:rgba(34,197,94,.45); color:var(--ok);}

  /* Viewer */
  .viewerInner{ padding:14px; display:flex; flex-direction:column; gap:12px; min-height:0; }
  .previewWrap{
    border:none;
    background:transparent;
    padding:0;
    display:flex;
    align-items:center;
    justify-content:center;
    min-height:260px;
    max-height:calc(100vh - 180px);
    overflow:hidden;
  }
  img.preview{
    max-width:100%;
    max-height:calc(100vh - 220px);
    width:auto;height:auto;
    object-fit:contain;
    border-radius:14px;
    cursor:zoom-in;
    display:block;
  }

  .hint{
    color:var(--muted);
    font-size:14px;
    padding:12px;
    border:1px dashed var(--border);
    border-radius:14px;
  }

  .btn{
    background:rgba(21,26,34,.92);
    border:1px solid rgba(255,255,255,.14);
    color:var(--text);
    padding:8px 10px;
    border-radius:12px;
    cursor:pointer;
    font-size:12px;
    user-select:none;
  }
  .btn:hover{filter:brightness(1.08);}
  .btn.primary{border-color:rgba(59,130,246,.5);}
  .btn.ok{border-color:rgba(34,197,94,.55); color:var(--ok);}
  .btn.danger{border-color:rgba(239,68,68,.55); color:#fecaca;}
  .viewerActions{display:flex; gap:8px; flex-wrap:wrap;}

  /* Info rechts */
  .infoBlock{ border:1px solid var(--border); border-radius:14px; background:#0f131b; overflow:hidden; }
  .infoTitle{
    margin:0; padding:10px 12px; background:#101522; border-bottom:1px solid var(--border);
    font-size:13px; display:flex; align-items:center; justify-content:space-between; gap:10px;
    cursor:pointer; user-select:none;
  }
  .infoBody{ padding:10px 12px; display:block; }
  .infoBody ul{ margin:0; padding-left:18px; }
  .infoBody li{ margin:6px 0; }

  /* ‚úÖ Status + Profilbild UNTEREINANDER */
  .statusWithPic{
    display:flex;
    flex-direction:column;
    gap:10px;
    align-items:flex-end;
  }
  .profileWrap{
    width:170px;
    height:260px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.12);
    overflow:hidden;
    background:rgba(0,0,0,.10);
    box-shadow:
      0 0 0 3px rgba(255,255,255,.05),
      0 10px 35px rgba(0,0,0,.55);
    cursor:zoom-in;
  }
  .profileWrap img{
    width:100%;
    height:100%;
    object-fit:contain;   /* GANZER K√∂rper sichtbar */
    object-position:center;
    background:transparent;
  }

  /* Lightbox */
  .lightbox{position:fixed; inset:0; background:rgba(0,0,0,.82); display:none; z-index:9999;}
  .lightbox.open{display:block;}
  .lightbox .topbar{
    position:fixed; top:10px; left:10px; right:10px;
    display:flex; justify-content:space-between; align-items:center; gap:10px;
    z-index:10000;
  }
  .lightbox .stage{position:absolute; inset:0; overflow:auto; padding:70px 24px 24px;}
  .lightbox .stageInner{width:max-content; height:max-content; margin:auto;}
  .lightbox img{
    display:block; transform-origin: top left;
    border-radius:16px; border:1px solid rgba(255,255,255,.12);
    background:#0b0e13;
  }

  @media(max-width:1100px){
    .app{grid-template-columns:1fr; height:auto;}
    .panel{min-height:unset;}
    .previewWrap, img.preview{max-height:65vh;}
    .statusWithPic{align-items:flex-start;}
  }
</style>
</head>

<body>
<div class="app">

  <!-- Sidebar -->
  <section class="panel">
    <div class="panelHeader">
      <div class="brand">
        <div class="mark">‚≠ê</div>
        <h1 class="brandTitle">Standorte & Routen</h1>
      </div>
      <div class="subRight">SD</div>
    </div>

    <div class="searchWrap">
      <input id="search" class="search" placeholder="Suchen‚Ä¶">
    </div>

    <div class="scroll">
      <div class="summary">
        <b>Gesamt</b>
        <span class="pill" id="overallPill">‚Äî</span>
      </div>
      <div id="groups"></div>
    </div>
  </section>

  <!-- Viewer -->
  <section class="panel">
    <div class="panelHeader">
      <div class="brand">
        <div class="mark">üó∫Ô∏è</div>
        <h1 class="brandTitle" id="currentTitle">Vorschau</h1>
      </div>
      <div class="subRight" id="currentSub">‚Äî</div>
    </div>

    <div class="viewerInner" id="content">
      <div class="hint">Links ausw√§hlen ‚Üí rechts √∂ffnet sich das Bild. (Klick aufs Bild = Zoom)</div>
    </div>
  </section>

  <!-- Info rechts -->
  <section class="panel">
    <div class="panelHeader">
      <div class="brand">
        <div class="mark">‚ÑπÔ∏è</div>
        <h1 class="brandTitle">Info & Ablauf</h1>
      </div>
      <div class="subRight">SD</div>
    </div>

    <div class="scroll">
      <div class="infoBlock">
        <div class="infoTitle" data-toggle="info1">Allgemein <span class="subRight">‚ñº</span></div>
        <div class="infoBody" id="info1">
          <ul>
            <li><b>Jede Route darf nur 1√ó pro Tag gest√ºrmt werden.</b></li>
          </ul>
        </div>
      </div>

      <div style="height:10px"></div>

      <div class="infoBlock">
        <div class="infoTitle" data-toggle="info2">Reset / St√ºrmen <span class="subRight">‚ñº</span></div>
        <div class="infoBody" id="info2">
          <ul>
            <li><b>Reset</b> = Situation neu bewerten, Abstand nehmen, neue Ansage.</li>
            <li><b>St√ºrmen</b> nur nach Befehl / Freigabe.</li>
            <li>Priorit√§t: <b>Eigenschutz</b> ‚Üí <b>Funk</b> ‚Üí <b>Beweissicherung</b>.</li>
          </ul>
        </div>
      </div>

      <div style="height:10px"></div>

      <div class="infoBlock">
        <div class="infoTitle" data-toggle="info3">Durchf√ºhrung <span class="subRight">‚ñº</span></div>
        <div class="infoBody" id="info3">
          <ul>
            <li>Briefing ‚Üí Rollenverteilung ‚Üí Perimeter.</li>
            <li>Zugriff/Festnahmen ‚Üí Rechte ‚Üí Transport.</li>
            <li>Bericht / Evidence sichern.</li>
          </ul>
        </div>
      </div>

      <div style="height:14px"></div>

      <!-- ‚úÖ Status + Profilbild DARUNTER -->
      <div class="hint" style="margin:0;">
        <div class="statusWithPic">
          <div>
            <b>Status:</b> ‚úÖ = bereits gest√ºrmt ‚Ä¢ ‚Äî = offen
          </div>

          <div class="profileWrap" id="profileCard" title="profil.png">
            <img src="images/profil.png" alt="Profil">
          </div>
        </div>
      </div>

    </div>
  </section>

</div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <div class="topbar">
    <div class="btn" id="lbTitle">‚Äî</div>
    <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;">
      <div class="btn" id="zoomOut">‚àí</div>
      <div class="btn" id="zoomReset">Fit</div>
      <div class="btn" id="zoomIn">+</div>
      <div class="btn" id="lbClose">Schlie√üen (Esc)</div>
    </div>
  </div>
  <div class="stage" id="lbStage">
    <div class="stageInner">
      <img id="lbImg" alt="">
    </div>
  </div>
</div>

<script>
  const icons = {"Weed":"üåø","Meth":"üíâ","Koks":"‚ùÑÔ∏è","LSD":"üß™","Waffen":"üî´","Schwarzmarkt":"üï∏Ô∏è"};
  const order = ["Weed","Meth","Koks","LSD","Waffen","Schwarzmarkt"];

  const elGroups = document.getElementById("groups");
  const elSearch = document.getElementById("search");
  const elContent = document.getElementById("content");
  const elTitle = document.getElementById("currentTitle");
  const elSub = document.getElementById("currentSub");
  const overallPill = document.getElementById("overallPill");

  const lightbox = document.getElementById("lightbox");
  const lbImg = document.getElementById("lbImg");
  const lbTitle = document.getElementById("lbTitle");
  const lbClose = document.getElementById("lbClose");
  const lbStage = document.getElementById("lbStage");
  const zoomInBtn = document.getElementById("zoomIn");
  const zoomOutBtn = document.getElementById("zoomOut");
  const zoomResetBtn = document.getElementById("zoomReset");

  let groupedClean = [];
  let collapsed = new Set();
  let activeItem = null;
  let zoom = 1;

  const STORAGE_KEY = "sd_raids_status_v6";
  function loadStatus(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}"); }catch{ return {}; } }
  function saveStatus(obj){ localStorage.setItem(STORAGE_KEY, JSON.stringify(obj)); }
  function isStormed(file){ const s=loadStatus(); return !!s[file]; }
  function setStormed(file,val){ const s=loadStatus(); if(val) s[file]=true; else delete s[file]; saveStatus(s); }
  function resetAllStormed(){ saveStatus({}); }

  function normKey(s){
    return (s||"").toLowerCase().trim()
      .replaceAll("√§","ae").replaceAll("√∂","oe").replaceAll("√º","ue").replaceAll("√ü","ss")
      .replace(/[^a-z0-9]+/g," ").replace(/\s+/g," ").trim();
  }
  function niceNameFromFile(filename){
    return filename.replace(/\.[^.]+$/,"").replace(/[_-]+/g," ").replace(/\s+/g," ").trim();
  }

  /* ‚úÖ Namen ohne Orte */
  function simplifyDisplayName(raw){
    const n = normKey(raw);

    if(n.includes("waffenhersteller")) return "Waffenhersteller";
    if(n.includes("waffenteile")) return "Waffenteile";
    if(n.includes("schwarzmarkt")) return "Schwarzmarkt";
    if(n.includes("lsd") && (n.includes("spot") || n.includes("punkt"))) return "LSD Spot";

    const hasWeed = n.includes("weed");
    const hasMeth = n.includes("meth");
    const hasKoks = n.includes("koks") || n.includes("kokain") || n.includes("coke");
    const hasLsd  = n.includes("lsd");
    const isVerkaeufer = n.includes("verkaeufer") || n.includes("dealer");
    const isVerarbeiter = n.includes("verarbeiter") || n.includes("verarbeitung");
    const isRoute = n.includes("route");

    if(hasWeed){
      if(isVerarbeiter) return "Weed Verarbeiter";
      if(isVerkaeufer) return "Weed Verk√§ufer";
      if(isRoute) return "Weed Route";
      return "Weed";
    }
    if(hasMeth){
      if(isVerarbeiter) return "Meth Verarbeiter";
      if(isVerkaeufer) return "Meth Verk√§ufer";
      if(isRoute) return "Methroute";
      return "Meth";
    }
    if(hasKoks){
      if(isVerkaeufer) return "Koks Verk√§ufer";
      if(isRoute) return "Koksroute";
      return "Koks";
    }
    if(hasLsd){
      if(isRoute) return "LSD Route";
      return "LSD";
    }

    return raw;
  }

  function categoryFromName(name){
    const n = normKey(name);
    if (n.includes("weed")) return "Weed";
    if (n.includes("meth")) return "Meth";
    if (n.includes("koks") || n.includes("kokain") || n.includes("coke")) return "Koks";
    if (n.includes("lsd")) return "LSD";
    if (n.includes("waffen") || n.includes("waffenteile") || n.includes("waffenhersteller")) return "Waffen";
    if (n.includes("schwarzmarkt")) return "Schwarzmarkt";
    return null;
  }

  function inferOwnerRepo(){
    const host = window.location.hostname.toLowerCase();
    const path = window.location.pathname.replace(/^\/+/, "").split("/").filter(Boolean);
    if(host.endsWith(".github.io")){
      const owner = host.split(".github.io")[0];
      const repo = path[0] || "";
      return { owner, repo };
    }
    return { owner: "Firat0095", repo: "Sheriff--Routen" };
  }

  function computeCounts(){
    let total = 0, done = 0;
    const perGroup = {};
    for(const g of groupedClean){
      const t = g.items.length;
      const d = g.items.filter(it=>isStormed(it.file)).length;
      perGroup[g.group] = { total:t, done:d };
      total += t; done += d;
    }
    return { total, done, perGroup };
  }
  function updateSummaryUI(){
    const { total, done } = computeCounts();
    overallPill.textContent = `${done} / ${total} gest√ºrmt`;
    overallPill.className = "pill " + (total>0 && done===total ? "ok" : "");
  }

  /* Lightbox */
  function applyZoom(){ lbImg.style.transform = `scale(${zoom})`; }
  function fitZoomLimited(){
    const rect = lbStage.getBoundingClientRect();
    const iw = lbImg.naturalWidth, ih = lbImg.naturalHeight;
    if(!iw || !ih){ zoom = 0.9; applyZoom(); return; }
    const scale = Math.min((rect.width * 0.92) / iw, (rect.height * 0.92) / ih);
    zoom = Math.min(1.0, scale);
    applyZoom();
    lbStage.scrollLeft = 0; lbStage.scrollTop = 0;
  }
  function openLightbox(src, title){
    lbImg.src = src;
    lbTitle.textContent = title;
    lightbox.classList.add("open");
    zoom = 0.95;
    lbImg.onload = () => fitZoomLimited();
  }
  function closeLightbox(){ lightbox.classList.remove("open"); lbImg.src=""; }
  function stepZoom(d){
    zoom = Math.max(0.25, Math.min(1.6, zoom + d));
    applyZoom();
  }
  zoomInBtn.onclick  = ()=> stepZoom(0.10);
  zoomOutBtn.onclick = ()=> stepZoom(-0.10);
  zoomResetBtn.onclick = ()=> fitZoomLimited();
  lbClose.onclick = closeLightbox;
  lightbox.addEventListener("click", e=>{ if(e.target===lightbox) closeLightbox(); });
  document.addEventListener("keydown", e=>{ if(e.key==="Escape") closeLightbox(); });

  /* Profilbild klickbar */
  const profileCard = document.getElementById("profileCard");
  if(profileCard){
    profileCard.addEventListener("click", ()=> openLightbox("images/profil.png","Profil"));
  }

  function renderViewer(item){
    activeItem = item;
    elTitle.textContent = item.displayName;
    elSub.textContent = item.group;

    const stormed = isStormed(item.file);
    elContent.innerHTML = "";

    const actions = document.createElement("div");
    actions.className = "viewerActions";

    const toggleBtn = document.createElement("button");
    toggleBtn.className = "btn " + (stormed ? "ok" : "primary");
    toggleBtn.textContent = stormed ? "‚úÖ Gest√ºrmt: JA (umschalten)" : "‚õî Gest√ºrmt: NEIN (umschalten)";
    toggleBtn.onclick = () => {
      setStormed(item.file, !isStormed(item.file));
      renderViewer(item);
      render(elSearch.value);
    };

    const resetBtn = document.createElement("button");
    resetBtn.className = "btn danger";
    resetBtn.textContent = "Reset (nur diese Route)";
    resetBtn.onclick = () => {
      setStormed(item.file, false);
      renderViewer(item);
      render(elSearch.value);
    };

    const resetAllBtn = document.createElement("button");
    resetAllBtn.className = "btn danger";
    resetAllBtn.textContent = "Reset ALL";
    resetAllBtn.onclick = () => {
      resetAllStormed();
      renderViewer(item);
      render(elSearch.value);
    };

    actions.appendChild(toggleBtn);
    actions.appendChild(resetBtn);
    actions.appendChild(resetAllBtn);

    const wrap = document.createElement("div");
    wrap.className = "previewWrap";

    const img = document.createElement("img");
    img.className = "preview";
    img.src = item.file;
    img.alt = item.displayName;
    img.onclick = ()=> openLightbox(item.file, item.displayName);
    img.onerror = ()=> { wrap.innerHTML = `<div class="hint">‚ùå Bild l√§dt nicht: <b>${item.file}</b></div>`; };

    wrap.appendChild(img);

    elContent.appendChild(actions);
    elContent.appendChild(wrap);
  }

  function toggleGroup(g){
    if(collapsed.has(g)) collapsed.delete(g);
    else collapsed.add(g);
    render(elSearch.value);
  }

  function render(filterRaw=""){
    const filter = (filterRaw||"").trim().toLowerCase();
    elGroups.innerHTML = "";

    const counts = computeCounts();

    groupedClean.forEach(g=>{
      const items = g.items.filter(it => !filter || it.displayName.toLowerCase().includes(filter));
      if(filter && items.length===0) return;

      const wrap = document.createElement("div");
      wrap.className = "group";

      const header = document.createElement("div");
      header.className = "groupHeader";

      const cg = counts.perGroup[g.group] || {done:0,total:items.length};
      const pill = `<span class="pill ${cg.total>0 && cg.done===cg.total ? "ok":""}">${cg.done}/${cg.total}</span>`;

      header.innerHTML =
        `<div class="left"><span>${icons[g.group]||"üìç"}</span><b>${g.group}</b></div>` +
        `<div style="display:flex;gap:8px;align-items:center">${pill}<span class="badgeCount">${items.length}</span></div>`;
      header.onclick = ()=> toggleGroup(g.group);
      wrap.appendChild(header);

      const body = document.createElement("div");
      body.className = "groupBody";
      body.style.display = collapsed.has(g.group) ? "none" : "flex";

      items.forEach(it=>{
        const btn = document.createElement("div");
        const active = activeItem && activeItem.file === it.file;
        btn.className = "item" + (active ? " active" : "");

        const stormed = isStormed(it.file);
        const badge = `<span class="statusBadge ${stormed ? "ok" : ""}">${stormed ? "‚úÖ gest√ºrmt" : "‚Äî offen"}</span>`;

        btn.innerHTML = `<span>${it.displayName}</span>${badge}`;
        btn.onclick = ()=> { renderViewer(it); render(elSearch.value); };
        body.appendChild(btn);
      });

      wrap.appendChild(body);
      elGroups.appendChild(wrap);
    });

    if(!elGroups.children.length){
      const empty = document.createElement("div");
      empty.className="hint";
      empty.textContent="Keine Treffer.";
      elGroups.appendChild(empty);
    }

    updateSummaryUI();
  }

  async function loadFromGitHub(){
    elGroups.innerHTML = `<div class="hint">Lade Bilder aus GitHub‚Ä¶</div>`;
    try{
      const { owner, repo } = inferOwnerRepo();
      const url = `https://api.github.com/repos/${owner}/${repo}/contents/images`;
      const res = await fetch(url, {headers: {"Accept":"application/vnd.github+json"}});
      if(!res.ok) throw new Error(`GitHub API Fehler: ${res.status}`);

      const data = await res.json();
      const files = (Array.isArray(data) ? data : [])
        .map(x => x.name)
        .filter(n => /\.(png|jpg|jpeg|webp)$/i.test(n))
        .filter(n => n.toLowerCase() !== "profil.png"); // Profilbild nicht als Route

      const all = files.map(fn=>{
        const rawName = niceNameFromFile(fn);
        const group = categoryFromName(rawName);
        if(!group) return null;
        return {
          group,
          rawName,
          displayName: simplifyDisplayName(rawName),
          file: `images/${encodeURIComponent(fn)}`
        };
      }).filter(Boolean);

      // Dedup + "detail" raus
      const seenName = new Set();
      const seenFile = new Set();
      const deduped = [];
      for(const it of all){
        const nk = normKey(it.displayName);
        const fk = it.file.toLowerCase();
        if(nk.includes("detail")) continue;
        if(seenName.has(nk) || seenFile.has(fk)) continue;
        seenName.add(nk); seenFile.add(fk);
        deduped.push(it);
      }

      const map = {};
      for(const it of deduped) (map[it.group] ||= []).push(it);
      Object.keys(map).forEach(g => map[g].sort((a,b)=> a.displayName.localeCompare(b.displayName,"de",{sensitivity:"base"})));

      groupedClean = order.filter(g => map[g]?.length).map(g => ({group:g, items: map[g]}));
      render("");
    }catch(e){
      elGroups.innerHTML = `<div class="hint">Fehler beim Laden. √ñffne die Seite √ºber <b>GitHub Pages</b>.</div>`;
      console.error(e);
    }
  }

  document.addEventListener("click", (e)=>{
    const t = e.target.closest("[data-toggle]");
    if(!t) return;
    const id = t.getAttribute("data-toggle");
    const body = document.getElementById(id);
    if(!body) return;
    body.style.display = (body.style.display === "none") ? "block" : "none";
  });

  elSearch.addEventListener("input", ()=> render(elSearch.value));
  loadFromGitHub();
</script>
</body>
</html>
